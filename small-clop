#!/bin/bash

cd simulations;

# Run tests
#python -m unittest discover . '*test*.py'

# python experiment.py  \
# 	--numClients 150 \
# 	--numServers 50 \
# 	--numWorkload 200 \
# 	--workloadModel poisson \
# 	--serverConcurrency 4 \
# 	--serviceTime 2.00\
# 	--utilization 0.05 \
# 	--serviceTimeModel random.expovariate \
# 	--replicationFactor 3 \
# 	--selectionStrategy pending \
# 	--shadowReadRatio 0.1 \
# 	--accessPattern uniform \
# 	--nwLatencyBase 2.00 \
# 	--nwLatencyMu 0.0\
# 	--nwLatencySigma 0.00 \
# 	--expPrefix oracle\
# 	--simulationDuration 50000\
# 	--seed 2\
# 	--numRequests 1000000\
# 	--logFolder logs\
# 	--expScenario timeVaryingServiceTimeServers\
# 	--demandSkew 0.0\
# 	--highDemandFraction 0.0\
# 	--slowServerFraction 0.0\
# 	--slowServerSlowness 0.0\
# 	--intervalParam 500\
# 	--timeVaryingDrift 5;

# # To profile, replace the first line with:
# # python -m cProfile -o output.txt experiment.py \"


#    --switchForwardingStrategy Clairvoyant \
#    --switchSelectionStrategy Clairvoyant \


# time units in microseconds
# storage units in megabytes
# data transfer units in megabytes/sec

python networkExperiment.py  \
 	--iLeaf 4 \
 	--iSpine 3 \
 	--numClients 2 \
 	--numServers 8 \
 	--hostsPerLeaf 8 \
 	--spineLeafBW 1250 \
 	--leafHostBW 1250 \
    --utilization 0.7\
    --expScenario base\
    --swProcTime 0.2 \
    --linkPropDelay 0.4 \
    --valueSizeModel pareto \
    --packetSize 0.001 \
    --switchBufferSize 10000 \
    --switchForwardingStrategy C4 \
    --switchSelectionStrategy C4 \
	--numWorkload 10 \
	--workloadModel poisson \
	--serverConcurrency 4 \
	--serviceTime 100 \
	--serviceTimeModel random.expovariate \
	--replicationFactor 3 \
	--rateInterval 20\
	--cubicC 0.000004\
	--cubicSmax 10\
	--cubicBeta 0.2\
	--hysterisisFactor 2\
	--selectionStrategy expDelay \
	--shadowReadRatio 0.0 \
	--accessPattern uniform \
	--expPrefix expDelay \
	--simulationDuration 10000000 \
	--seed 1 \
	--numRequests 10000\
	--logFolder logs\
	--demandSkew 0.0\
	--highDemandFraction 0.0\
	--slowServerFraction 0.3\
	--slowServerSlowness 0.9\
	--intervalParam 500\
	--timeVaryingDrift 5\
    --readFraction 1\
    --bckTrafficDelay 1\
    --bckSpawnDelay 250\
    --logLevel INFO;
  

cd ..
cd plotting;
# Rscript timeseries.r primary;
# Rscript timeseries.r rp;
# Rscript timeseries.r pending;
# Rscript timeseries.r pendingXserviceTime;
# Rscript timeseries.r oracle;
# Rscript timeseries.r expDelay;
# Rscript networkplots.r expDelay
cd ..
